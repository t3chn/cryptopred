# MLflow Tracking Server - Bitnami Helm Chart
# https://artifacthub.io/packages/helm/bitnami/mlflow

# Override image to use available versions
image:
  registry: docker.io
  repository: bitnami/mlflow
  tag: 2.17.2-debian-12-r2

# Volume permissions init container
volumePermissions:
  enabled: false

tracking:
  service:
    type: ClusterIP
  auth:
    enabled: true
    username: admin
    password: mlflow123

# Disable MLflow run service (we only need tracking)
run:
  enabled: false

# Disable built-in MinIO - use existing from RisingWave
minio:
  enabled: false

# External S3 (MinIO from RisingWave)
externalS3:
  host: "risingwave-minio.risingwave.svc.cluster.local"
  port: 9000
  useCredentialsInSecret: true
  existingSecret: "mlflow-minio-secret"
  existingSecretAccessKeyIDKey: "accesskey"
  existingSecretKeySecretKey: "secretkey"
  protocol: "http"
  bucket: "mlflow"
  serveArtifacts: true

# Built-in PostgreSQL for metadata
postgresql:
  enabled: true
  image:
    registry: docker.io
    repository: bitnami/postgresql
    tag: 16.6.0-debian-12-r0
  auth:
    username: mlflow
    password: mlflow
    database: mlflow
  primary:
    persistence:
      enabled: true
      size: 1Gi
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 256Mi

# Wait init container
waitContainer:
  image:
    registry: docker.io
    repository: bitnami/os-shell
    tag: 12-debian-12-r35

# Resource limits for dev
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi
